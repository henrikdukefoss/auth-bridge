<!DOCTYPE html>
<html>
  <head><title>Redirecting to app...</title></head>
  <body style="background:#111; color:white; font-family:sans-serif; text-align:center; padding:40px;">
    <h2>üîó Logging you in...</h2>
    <p>Please confirm the "Open Electron" prompt to finish logging in.</p>
    <p>You‚Äôll be redirected automatically after a few seconds.</p>

    <script>
      const params = new URLSearchParams(window.location.hash.slice(1));
      const access_token = params.get("access_token");
      const refresh_token = params.get("refresh_token");

      if (access_token && refresh_token) {
        // Trigger Electron app deep link via hidden iframe
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = `overlai://auth?access_token=${access_token}&refresh_token=${refresh_token}`;
        document.body.appendChild(iframe);

        // Wait ~6 seconds, then redirect to site
        setTimeout(() => {
          window.location.href = "https://www.overl.ai";
        }, 6000);
      } else {
        document.body.innerHTML = "<h2>‚ùå Missing token(s)</h2><p>Something went wrong with login.</p>";
        console.error("Missing token(s):", { access_token, refresh_token });
      }
    </script>
  </body>
</html>
